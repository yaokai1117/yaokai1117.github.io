<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title> by </title>
  </head>

  <body>
    <header>
      <div class="inner">
        <a href="/">
          <h1></h1>
        </a>
        <h2></h2>
        
        
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <p>今天来写一点使用JDOM在java中解析XML文件的方法。由于试着参加了我们学校今年的igem（还不知道能不能进入最终的队伍，筛人方法太诡异，sad…），需要看获奖作品的java源码，写这篇博文的缘由也是因为在所看的项目中大量涉及到使用JDOM进行XML文件的处理。</p>

<h3 id="xml">什么是XML</h3>

<blockquote>
  <p>XML指 <em>可扩展标记语言（EXtensible Markup Language）</em>，它是一种标记语言，很类似html。
XML 的设计宗旨是传输数据，而非显示数据。
XML 标签没有被预定义。您需要自行定义标签。
XML 被设计为具有自我描述性。</p>
</blockquote>

<p>以上摘自w3school对XML的描述。XML被广泛的运用于数据的传输，它的语法非常简单，一个XML文档主要由元素和属性构成，它是以树结构组织起来的，必须具有一个根节点（在我们接下来生成XML文档时会体会到这一点）。来看一个同样来着w3school的具体示例：</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;bookstore&gt;</span>
<span class="nt">&lt;book</span> <span class="na">category=</span><span class="s">&quot;COOKING&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>Everyday Italian<span class="nt">&lt;/title&gt;</span> 
  <span class="nt">&lt;author&gt;</span>Giada De Laurentiis<span class="nt">&lt;/author&gt;</span> 
  <span class="nt">&lt;year&gt;</span>2005<span class="nt">&lt;/year&gt;</span> 
  <span class="nt">&lt;price&gt;</span>30.00<span class="nt">&lt;/price&gt;</span> 
<span class="nt">&lt;/book&gt;</span>
<span class="nt">&lt;book</span> <span class="na">category=</span><span class="s">&quot;CHILDREN&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>Harry Potter<span class="nt">&lt;/title&gt;</span> 
  <span class="nt">&lt;author&gt;</span>J K. Rowling<span class="nt">&lt;/author&gt;</span> 
  <span class="nt">&lt;year&gt;</span>2005<span class="nt">&lt;/year&gt;</span> 
  <span class="nt">&lt;price&gt;</span>29.99<span class="nt">&lt;/price&gt;</span> 
<span class="nt">&lt;/book&gt;</span>
<span class="nt">&lt;book</span> <span class="na">category=</span><span class="s">&quot;WEB&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>Learning XML<span class="nt">&lt;/title&gt;</span> 
  <span class="nt">&lt;author&gt;</span>Erik T. Ray<span class="nt">&lt;/author&gt;</span> 
  <span class="nt">&lt;year&gt;</span>2003<span class="nt">&lt;/year&gt;</span> 
  <span class="nt">&lt;price&gt;</span>39.95<span class="nt">&lt;/price&gt;</span> 
<span class="nt">&lt;/book&gt;</span>
<span class="nt">&lt;/bookstore&gt;</span></code></pre></div>

<h4 id="section">值得注意的几点是:</h4>

<ul>
  <li>
    <p>XML标签<strong>必须</strong>被正确地闭合。与html不同，不闭合的标签被XML认为是语法错误。</p>
  </li>
  <li>
    <p>属性必须加引号，且<strong>不宜多用</strong>,滥用属性不符合XML的宗旨，也影响XML文件的可拓展性。一个被广泛认可的理念是<em>”元数据（有关数据的数据）应当存储为属性，而数据本身应当存储为元素“</em></p>
  </li>
  <li>
    <p>命名时，使用下划线’_‘，而非减号’-‘或’.’以及’:’，否则一些情况下会引起错误。</p>
  </li>
  <li>
    <p>类似与于html语言，XML以&lt;!– This is a comment –&gt;的风格进行注释。</p>
  </li>
  <li>
    <p>实体引用的问题，即一些特殊字符如’&lt;’等不能直接用，需要使用实体引用。如用”&amp;amp;”代替”＆”</p>
  </li>
</ul>

<h3 id="jdomjavaxml">使用JDOM在java中解析XML文件</h3>

<p>在java中使用XML文件主要有四种方法DOM、SAX、JDOM和DOM4J，这四种方法的比较在<a href="http://www.cnblogs.com/lanxuezaipiao/archive/2013/05/17/3082949.html">这篇文章</a>有所说明。因为里面有些内容我还不甚理解，就不在这里再讨论了，既然要看的项目中使用的是JDOM，并且我比较下来JDOM的语法也是最清晰的（简化了DOM的不少东西，同时大量使用了java集合类），所以就先了解JDOM吧。</p>

<p>（顺便说一句，无意中发现上一段中所提博文的作者是我们学校的一个研究生学姐，以前还看过她的一篇有关面试的文章，世界真小啊。这位学姐拿了百度和阿里的offer，最终去了阿里，也是很厉害。）</p>

<p>首先引两句上述博文中的话来简单说明一下JDOM(Java-based Document Object Model)的特点：</p>

<blockquote>
  <p>JDOM与DOM主要有两方面不同。首先，JDOM仅使用具体类而不使用接口。这在某些方面简化了API，但是也限制了灵活性。第二，API大量使用了Collections类，简化了那些已经熟悉这些类的Java开发者的使用。<br />
JDOM自身不包含解析器。它通常使用SAX2解析器来解析和验证输入XML文档（尽管它还可以将以前构造的DOM表示作为输入）。它包含一些转换器以将JDOM表示输出成SAX2事件流、DOM模型或XML文本文档。JDOM是在Apache许可证变体下发布的开放源码。</p>
</blockquote>

<p>接下来说说用JDOM解析XML的简单流程，首先，如上文所说，JDOM本身不包含解析器，所以第一步是创建一个SAXBuilder，来生成我们所需要的文档对象（document对象）；第二步就是document对象的创建，或者说将XML文件转化为java能“看得懂”的document对象，可以用java.io中的FILE对象来作为build()函数的参数，也可以使用InputStream；第三步，是获取XML文件中的根元素，就是上文中强调的那个。因为XML是以树结构组织起来的，所以这一步配合第四步，获得并遍历一个元素的children，实际上就能完成对整个XML文件的操纵。</p>

<p>后续的步骤，如对元素进行修改增删，以及生成一个新的XML文档，看着API来都是很容易的，下面是我的实验代码，实现了对XML文档的读取和生成。其中第一部分的输入文件就是上文中用于举例的XML文件，输出文件见最下面。</p>

<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">testJDOM</span> <span class="o">{</span>
	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[])</span> <span class="kd">throws</span> <span class="n">JDOMException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
		
		<span class="cm">/*</span>
<span class="cm">		 * this part is to parse a exited XML document</span>
<span class="cm">		 */</span>
		<span class="n">SAXBuilder</span> <span class="n">builder</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">SAXBuilder</span><span class="o">();</span>				<span class="c1">//Step 1: make a builder</span>
		<span class="n">String</span> <span class="n">xmlPath</span> <span class="o">=</span> <span class="s">&quot;src/learn/xml/test.xml&quot;</span><span class="o">;</span>									
		<span class="n">File</span> <span class="n">inputFile</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="n">xmlPath</span><span class="o">);</span>
		<span class="n">Document</span> <span class="n">document</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="na">build</span><span class="o">(</span><span class="n">inputFile</span><span class="o">);</span>		<span class="c1">//Step 2: build a document</span>
		<span class="n">Element</span> <span class="n">bookstore</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="na">getRootElement</span><span class="o">();</span>		<span class="c1">//Step 3: get the root element</span>
		<span class="n">List</span><span class="o">&lt;</span><span class="n">Element</span><span class="o">&gt;</span> <span class="n">booklist</span> <span class="o">=</span> <span class="n">bookstore</span><span class="o">.</span><span class="na">getChildren</span><span class="o">();</span>	<span class="c1">//Step 4: get children </span>
		<span class="k">for</span> <span class="o">(</span><span class="n">Element</span> <span class="n">book</span> <span class="o">:</span> <span class="n">booklist</span> <span class="o">)</span> <span class="o">{</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">book</span><span class="o">.</span><span class="na">getAttributeValue</span><span class="o">(</span><span class="s">&quot;category&quot;</span><span class="o">)</span> <span class="o">+</span> <span class="s">&quot; : &quot;</span><span class="o">);</span>
			<span class="n">List</span><span class="o">&lt;</span><span class="n">Element</span><span class="o">&gt;</span> <span class="n">bookmetalist</span> <span class="o">=</span> <span class="n">book</span><span class="o">.</span><span class="na">getChildren</span><span class="o">();</span> 
			<span class="k">for</span> <span class="o">(</span><span class="n">Element</span> <span class="n">bookmeta</span> <span class="o">:</span> <span class="n">bookmetalist</span><span class="o">)</span> <span class="o">{</span>
				<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">bookmeta</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; : &quot;</span> <span class="o">+</span> <span class="n">bookmeta</span><span class="o">.</span><span class="na">getText</span><span class="o">());</span>
			<span class="o">}</span>
			<span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
		<span class="o">}</span>
		
		<span class="cm">/*</span>
<span class="cm">		 * this part is to write things to a new XML file</span>
<span class="cm">		 */</span>
		<span class="n">Document</span> <span class="n">myDocument</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Document</span><span class="o">();</span>
		<span class="n">String</span> <span class="n">xmlPath2</span> <span class="o">=</span> <span class="s">&quot;src/learn/xml/test2.xml&quot;</span><span class="o">;</span>
		
		<span class="n">Element</span> <span class="n">rootElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Element</span><span class="o">(</span><span class="s">&quot;root&quot;</span><span class="o">);</span>
		
		<span class="n">Element</span> <span class="n">element</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Element</span><span class="o">(</span><span class="s">&quot;student&quot;</span><span class="o">);</span>
		
		<span class="n">Element</span> <span class="n">nameElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Element</span><span class="o">(</span><span class="s">&quot;name&quot;</span><span class="o">);</span>
		<span class="n">nameElement</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&quot;yaokai&quot;</span><span class="o">);</span>
		<span class="n">Element</span> <span class="n">sexElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Element</span><span class="o">(</span><span class="s">&quot;sex&quot;</span><span class="o">);</span>
		<span class="n">sexElement</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&quot;male&quot;</span><span class="o">);</span>
		<span class="n">Element</span> <span class="n">descriptionElement</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Element</span><span class="o">(</span><span class="s">&quot;description&quot;</span><span class="o">);</span>
		<span class="n">descriptionElement</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&quot;yaokai is a student of School of Computer Science and Technology, USTC.&quot;</span><span class="o">);</span>
		
		<span class="n">element</span><span class="o">.</span><span class="na">addContent</span><span class="o">(</span><span class="n">nameElement</span><span class="o">);</span>
		<span class="n">element</span><span class="o">.</span><span class="na">addContent</span><span class="o">(</span><span class="n">sexElement</span><span class="o">);</span>
		<span class="n">element</span><span class="o">.</span><span class="na">addContent</span><span class="o">(</span><span class="n">descriptionElement</span><span class="o">);</span>
		
		<span class="n">rootElement</span><span class="o">.</span><span class="na">addContent</span><span class="o">(</span><span class="n">element</span><span class="o">);</span>
		<span class="n">myDocument</span><span class="o">.</span><span class="na">setRootElement</span><span class="o">(</span><span class="n">rootElement</span><span class="o">);</span>
		
		<span class="n">XMLOutputter</span> <span class="n">myOutputter</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">XMLOutputter</span><span class="o">();</span>
		<span class="n">OutputStream</span> <span class="n">myOStream</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">FileOutputStream</span><span class="o">(</span><span class="n">xmlPath2</span><span class="o">);</span>
		<span class="n">myOutputter</span><span class="o">.</span><span class="na">output</span><span class="o">(</span><span class="n">myDocument</span><span class="o">,</span> <span class="n">myOStream</span><span class="o">);</span>
	<span class="o">}</span>
<span class="o">}</span></code></pre></div>

<p>第二部分的输出文件：</p>

<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;root&gt;&lt;student&gt;&lt;name&gt;</span>yaokai<span class="nt">&lt;/name&gt;&lt;sex&gt;</span>male<span class="nt">&lt;/sex&gt;&lt;description&gt;</span>yaokai is a student of School of Computer Science and Technology, USTC.<span class="nt">&lt;/description&gt;&lt;/student&gt;&lt;/root&gt;</span></code></pre></div>


        </section>

        <aside id="sidebar">
          

          

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</p>
        </aside>
      </div>
    </div>

    
  </body>
</html>
